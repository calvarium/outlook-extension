<Window x:Class="outlook_extension.UI.Wpf.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:wpfui="clr-namespace:Wpf.Ui.Controls;assembly=Wpf.Ui"
        mc:Ignorable="d"
        Title="Quick Move Einstellungen"
        Width="700"
        Height="560"
        WindowStartupLocation="CenterOwner">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <ScrollViewer>
            <StackPanel>
                <TextBlock Text="Shortcut"
                           FontWeight="SemiBold"
                           Margin="0,0,0,6" />
                <wpfui:TextBox x:Name="ShortcutBox"
                               Text="{Binding Shortcut, UpdateSourceTrigger=PropertyChanged}"
                               IsReadOnly="True"
                               Padding="10"
                               PreviewKeyDown="OnShortcutKeyDown" />

                <TextBlock Text="Favoriten"
                           FontWeight="SemiBold"
                           Margin="0,20,0,6" />
                <wpfui:ListBox ItemsSource="{Binding Favorites}"
                               SelectedItem="{Binding SelectedFavorite, Mode=TwoWay}"
                               Height="160">
                    <wpfui:ListBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Label}" />
                        </DataTemplate>
                    </wpfui:ListBox.ItemTemplate>
                </wpfui:ListBox>
                <StackPanel Orientation="Horizontal"
                            Margin="0,8,0,0">
                    <wpfui:Button Content="Hinzufügen"
                                  Margin="0,0,8,0"
                                  Command="{Binding AddFavoriteCommand}" />
                    <wpfui:Button Content="Entfernen"
                                  Margin="0,0,8,0"
                                  Command="{Binding RemoveFavoriteCommand}" />
                    <wpfui:Button Content="▲"
                                  Margin="0,0,8,0"
                                  Command="{Binding MoveFavoriteUpCommand}" />
                    <wpfui:Button Content="▼"
                                  Command="{Binding MoveFavoriteDownCommand}" />
                </StackPanel>

                <TextBlock Text="Anzahl letzte Ziele"
                           FontWeight="SemiBold"
                           Margin="0,20,0,6" />
                <wpfui:NumberBox Minimum="1"
                                 Maximum="50"
                                 Value="{Binding MaxRecents, Mode=TwoWay}" />

                <wpfui:CheckBox Content="Nur Unterordner von Posteingang anzeigen"
                                IsChecked="{Binding ShowInboxOnly, Mode=TwoWay}"
                                Margin="0,16,0,0" />
                <wpfui:CheckBox Content="Archiv/Online-Archive anzeigen"
                                IsChecked="{Binding IncludeArchives, Mode=TwoWay}"
                                Margin="0,8,0,0" />

                <TextBlock Text="Theme"
                           FontWeight="SemiBold"
                           Margin="0,20,0,6" />
                <wpfui:ComboBox ItemsSource="{Binding ThemeOptions}"
                                SelectedItem="{Binding ThemeMode, Mode=TwoWay}" />

                <wpfui:Button Content="Ordnerliste neu laden"
                              Margin="0,20,0,0"
                              Command="{Binding RefreshFoldersCommand}" />
            </StackPanel>
        </ScrollViewer>

        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,16,0,0">
            <wpfui:Button Content="Abbrechen"
                          Margin="0,0,8,0"
                          Command="{Binding CancelCommand}" />
            <wpfui:Button Content="Speichern"
                          Command="{Binding SaveCommand}" />
        </StackPanel>
    </Grid>
</Window>
