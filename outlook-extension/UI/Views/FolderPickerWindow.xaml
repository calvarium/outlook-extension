<Window x:Class="outlook_extension.UI.Views.FolderPickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="clr-namespace:outlook_extension.UI.Controls"
        xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
        Title="Favoritenordner wählen"
        Width="560"
        Height="400"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <controls:SearchBarControl x:Name="SearchBar" PlaceholderText="Ordner suchen..." />

        <controls:ItemsRepeater Grid.Row="1"
                                Margin="0,12,0,12"
                                ItemsSource="{Binding Results}"
                                SelectedItem="{Binding SelectedResult, Mode=TwoWay}"
                                Background="Transparent"
                                BorderThickness="0"
                                MouseDoubleClick="OnResultsDoubleClick"
                                ScrollViewer.VerticalScrollBarVisibility="Auto">
            <controls:ItemsRepeater.ItemContainerStyle>
                <Style TargetType="ListBoxItem">
                    <Setter Property="Padding" Value="0" />
                    <Setter Property="Margin" Value="0" />
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="BorderThickness" Value="0" />
                </Style>
            </controls:ItemsRepeater.ItemContainerStyle>
            <controls:ItemsRepeater.ItemTemplate>
                <DataTemplate>
                    <Border Style="{StaticResource ResultItemBorderStyle}">
                        <StackPanel>
                            <TextBlock Style="{StaticResource PrimaryTextStyle}"
                                       FontSize="15"
                                       FontWeight="SemiBold"
                                       Text="{Binding DisplayName}" />
                            <TextBlock Style="{StaticResource SecondaryTextStyle}"
                                       FontSize="12"
                                       Margin="0,4,0,0"
                                       Text="{Binding DisplayPath}" />
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </controls:ItemsRepeater.ItemTemplate>
        </controls:ItemsRepeater>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right">
            <ui:Button Content="Auswählen" Click="OnConfirmClick" />
            <ui:Button Content="Abbrechen" Click="OnCancelClick" />
        </StackPanel>
    </Grid>
</Window>
